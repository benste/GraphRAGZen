<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Querying: Local Search &mdash; GraphRAGZen 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/sphinx_rtd_size.css?v=8f58cd29" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css?v=226d88b4" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=01f34227"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GraphRAGZen
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../motivation/index.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphzen_ideology/index.html">GraphRAGZen ideology</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo/index.html">TODO</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Prompts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prompts/default_prompts/index.html">Default Prompts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prompts/prompt_tuning/index.html">Prompt tuning Prompts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/graphragzen.html">graphragzen</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GraphRAGZen</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          























<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Querying: Local Search</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/graphragzen_concepts/local_querying.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="querying-local-search">
<h1>Querying: Local Search<a class="headerlink" href="#querying-local-search" title="Link to this heading"></a></h1>
<p>The Graph RAG library provides a robust mechanism for querying and retrieving context-relevant information by leveraging graph data, vector searches, and optionally source documents and cluster reports. The querying process is designed to find the most relevant information from a heterogeneous mix of data sources and to format this information into a coherent prompt that’s ready to send to an LLM.</p>
<p>Querying can be devided in local search (specific information from a small part of the graph) and global search (information from summaries of the whole graph)</p>
<p>see the following example on how to query using your graph for added context (click on source)
<a class="reference internal" href="../api/graphragzen.examples.query.question.html#graphragzen.examples.query.question" title="graphragzen.examples.query.question"><code class="xref py py-func docutils literal notranslate"><span class="pre">graphragzen.examples.query.question()</span></code></a></p>
<section id="overview-of-the-local-search-process">
<h2>Overview of the Local Search Process<a class="headerlink" href="#overview-of-the-local-search-process" title="Link to this heading"></a></h2>
<p>The querying for local serach process in <strong>GraphRAGZen</strong> integrates several components to construct a comprehensive response to a user’s query. This process involves:</p>
<ul>
<li><p>Semantic Vector Search: A semantic search is performed using vector representations of entities and the query. This step retrieves entities from the vector database that are most similar to the query based on their embeddings. The vector search is controlled by parameters like the number of similar entities to retrieve (top_k_similar_entities) and a score threshold (score_threshold) that filters out entities below a certain similarity score.</p></li>
<li><p>Graph Context Retrieval: Once the initial set of similar entities is identified, additional contextual information can be optionally retrieved from the graph:</p>
<blockquote>
<div><ul class="simple">
<li><p>Inside Edges: Edges whose both nodes are already present among the similar entities. This helps in identifying strong internal relationships within the group of entities that are relevant to the query.</p></li>
<li><p>Outside Edges: Edges where exactly one node is present among the similar entities. This step helps to explore peripheral relationships that might add contextual relevance to the retrieved entities.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Source Document Integration: If source documents are provided, they sources of the entities retrieved in the <em>Semantic Vector Search</em> step are added to the context. The number of such texts to include can be controlled by the <cite>top_k_source_documents</cite> parameter.</p></li>
<li><p>Cluster Report Summaries: These are summarizations of clustered graph nodes. These summaries can help in understanding broader trends or patterns that relate to the query and the retrieved entities. If available, cluster summaries coupled to the entities retrieved in the <em>Semantic Vector Search</em> step are added to the context. The number of cluster descriptions to include can be set using the <cite>top_k_cluster_descriptions`</cite> parameter.</p></li>
</ul>
</section>
<section id="prompt-construction-for-local-search">
<h2>Prompt Construction for Local Search<a class="headerlink" href="#prompt-construction-for-local-search" title="Link to this heading"></a></h2>
<p>After gathering all relevant data, a final prompt is constructed. The prompt combines:</p>
<ul class="simple">
<li><p>Node Descriptions: Information about nodes retrieved from the graph, including their category and a brief description.</p></li>
<li><p>Relationship Descriptions: Descriptions of edges (relationships) within and outside the set of similar entities.</p></li>
<li><p>Specific Source Contexts (optional): Direct excerpts or references from source documents.</p></li>
<li><p>Global Source Contexts (optional): Summaries from cluster reports.</p></li>
</ul>
<p>The prompt is formatted using a base prompt template, which is customized with the contextual data and the original query. This ensures that the constructed prompt is rich with relevant context, enhancing the accuracy and relevance of any subsequent operations, such as generating responses or extracting insights.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Ben Steemers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>